<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Doyen - Gestion Académique</title>
    <link href="style/doyen.css" rel="stylesheet">
   
</head>
<body>
    <div class="dashboard-container">
        <div class="sidebar" id="sidebar">
            <div class="logo-container">
                <div class="logo">Doyen</div>
            </div>
            
            <div class="user-info">
                <div class="user-name">Prof. Samir Meziane</div>
                <div class="user-role">Doyen - Faculté des Sciences</div>
            </div>
            
            <div class="menu-title">Navigation</div>
            <ul class="menu">
                <li class="menu-item active" onclick="changeTab('tableau-bord')">
                    <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                        <polyline points="9 22 9 12 15 12 15 22"></polyline>
                    </svg>
                    Tableau de Bord
                </li>
                <li class="menu-item" onclick="changeTab('supervision')">
                    <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M3 3h18v18H3zM8 12h8M12 8v8"></path>
                    </svg>
                    Supervision des Départements
                </li>
                <li class="menu-item" onclick="changeTab('demandes')">
                    <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                    Demandes Importantes
                </li>
                <li class="menu-item" onclick="changeTab('statistiques')">
                    <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M18 20V10M12 20V4M6 20v-6"></path>
                    </svg>
                    Statistiques Globales
                </li>
                <li class="menu-item">
                    <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M12 20h9M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
                    </svg>
                    Gestion des Signatures
                </li>
                <li class="menu-item">
                    <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                    </svg>
                    Paramètres
                </li>
            </ul>
            
            <div class="logout">
                <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                    <polyline points="16 17 21 12 16 7"></polyline>
                    <line x1="21" y1="12" x2="9" y2="12"></line>
                </svg>
                Déconnexion
            </div>
        </div>
        
        <div class="main-content">
            <div class="dashboard-header">
                <div>
                    <h1 class="welcome-text">Bonjour, Prof. Meziane</h1>
                    <p class="dashboard-date">Dimanche 13 avril 2025</p>
                </div>
            </div>
            
            <!-- Tab 1: Vue d'ensemble -->
            <div class="tab-content active" id="tableau-bord-content">
                <div class="cards-container">
                    <div class="card">
                        <div class="card-title">
                            <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                            </svg>
                            Étudiants
                        </div>
                        <div class="card-value" id="total-etudiants">5,823</div>
                        <div class="card-label">Total d'étudiants inscrits</div>
                    </div>
                    
                    <div class="card">
                        <div class="card-title">
                            <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            </svg>
                            Enseignants
                        </div>
                        <div class="card-value" id="total-enseignants">243</div>
                        <div class="card-label">Nombre d'enseignants</div>
                    </div>
                    
                    <div class="card">
                        <div class="card-title">
                            <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                                <line x1="8" y1="21" x2="16" y2="21"></line>
                                <line x1="12" y1="17" x2="12" y2="21"></line>
                            </svg>
                            Départements
                        </div>
                        <div class="card-value" id="total-departements">7</div>
                        <div class="card-label">Nombre de départements</div>
                    </div>
                    
                    <div class="card">
                        <div class="card-title">
                            <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <circle cx="12" cy="12" r="10"></circle>
                                <polyline points="12 6 12 12 16 14"></polyline>
                            </svg>
                            Demandes
                        </div>
                        <div class="card-value" id="total-demandes">32</div>
                        <div class="card-label">Demandes en attente</div>
                    </div>
                </div>
                
                <div class="content-section">
                    <h2 class="section-title">Activités Récentes</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Département</th>
                                <th>Activité</th>
                                <th>Statut</th>
                            </tr>
                        </thead>
                        <tbody id="activites-recentes-table">
                            <!-- Le contenu sera généré dynamiquement -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Tab 2: Supervision des Départements -->
            <div class="tab-content" id="supervision-content">
                <div class="content-section">
                    <h2 class="section-title">Vue d'ensemble des Départements</h2>
                    
                    <div class="search-filter-bar">
                        <input type="text" class="search-input" placeholder="Rechercher un département...">
                        <select class="filter-select" id="filter-statut-departement">
                            <option value="">Tous les statuts</option>
                            <!-- Options générées dynamiquement -->
                        </select>
                        <button class="search-btn">Rechercher</button>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>Département</th>
                                <th>Chef de Département</th>
                                <th>Étudiants</th>
                                <th>Enseignants</th>
                                <th>Performance</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="departements-table">
                            <!-- Le contenu sera généré dynamiquement -->
                        </tbody>
                    </table>
                </div>
                
                <div class="grid-2col">
                    <div class="content-section">
                        <h2 class="section-title">Rapports de Performance</h2>
                        <div class="chart-container">
                            <!-- Placeholder for chart -->
                            <div style="width:100%; height:100%; background:rgba(226, 232, 240, 0.3); border-radius:10px; display:flex; justify-content:center; align-items:center; color:var(--gray-color);">
                                Graphique des performances départementales
                            </div>
                        </div>
                    </div>
                    
                    <div class="content-section">
                        <h2 class="section-title">Répartition des Ressources</h2>
                        <div class="chart-container">
                            <!-- Placeholder for chart -->
                            <div style="width:100%; height:100%; background:rgba(226, 232, 240, 0.3); border-radius:10px; display:flex; justify-content:center; align-items:center; color:var(--gray-color);">
                                Graphique de répartition des ressources
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Tab 3: Demandes Importantes -->
            <div class="tab-content" id="demandes-content">
                <div class="content-section">
                    <h2 class="section-title">Demandes en Attente</h2>
                    
                    <div class="search-filter-bar">
                        <input type="text" class="search-input" placeholder="Rechercher des demandes...">
                        <select class="filter-select" id="filter-type-demande">
                            <option value="">Tous les types</option>
                            <!-- Options générées dynamiquement -->
                        </select>
                        <select class="filter-select" id="filter-departement">
                            <option value="">Tous les départements</option>
                            <!-- Options générées dynamiquement -->
                        </select>
                        <button class="search-btn">Rechercher</button>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Date</th>
                                <th>Département</th>
                                <th>Type</th>
                                <th>Objet</th>
                                <th>Priorité</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="demandes-en-attente-table">
                            <!-- Le contenu sera généré dynamiquement -->
                        </tbody>
                    </table>
                </div>
                
                <div class="content-section">
                    <h2 class="section-title">Demandes Récemment Traitées</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Date</th>
                                <th>Département</th>
                                <th>Type</th>
                                <th>Objet</th>
                                <th>Statut</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="demandes-traitees-table">
                            <!-- Le contenu sera généré dynamiquement -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Tab 4: Statistiques Globales -->
            <div class="tab-content" id="statistiques-content">
                <div class="cards-container">
                    <div class="card">
                        <div class="card-title">
                            <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                            </svg>
                            Taux de Satisfaction
                        </div>
                        <div class="card-value" id="taux-satisfaction">87%</div>
                        <div class="card-label">Satisfaction étudiante</div>
                    </div>
                    
                    <div class="card">
                        <div class="card-title">
                            <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                <polyline points="22 4 12 14.01 9 11.01"></polyline>
                            </svg>
                            Taux de Réussite
                        </div>
                        <div class="card-value" id="taux-reussite">76%</div>
                        <div class="card-label">Moyenne annuelle</div>
                    </div>
                    
                    <div class="card">
                        <div class="card-title">
                            <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <polyline points="20 6 9 17 4 12"></polyline>
                            </svg>
                            Complétion des Cours
                        </div>
                        <div class="card-value" id="completion-cours">93%</div>
                        <div class="card-label">Cours terminés</div>
                    </div>
                    
                    <div class="card">
                        <div class="card-title">
                            <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M20 12V8H6a2 2 0 0 1-2-2c0-1.1.9-2 2-2h12v4"></path>
                                <path d="M4 6v12c0 1.1.9 2 2 2h14v-4"></path>
                                <path d="M18 12a2 2 0 0 0 0 4h2v-4h-2z"></path>
                            </svg>
                            Budget Utilisé
                        </div>
                        <div class="card-value" id="budget-utilise">62%</div>
                        <div class="card-label">du budget annuel</div>
                    </div>
                </div>
                
                <div class="grid-2col">
                    <div class="content-section">
                        <h2 class="section-title">Évolution des Effectifs</h2>
                        <div class="chart-container">
                            <!-- Placeholder for chart -->
                            <div style="width:100%; height:100%; background:rgba(226, 232, 240, 0.3); border-radius:10px; display:flex; justify-content:center; align-items:center; color:var(--gray-color);">
                                Graphique d'évolution des effectifs
                            </div>
                        </div>
                    </div>
                    
                    <div class="content-section">
                        <h2 class="section-title">Publications Scientifiques</h2>
                        <div class="chart-container">
                            <!-- Placeholder for chart -->
                            <div style="width:100%; height:100%; background:rgba(226, 232, 240, 0.3); border-radius:10px; display:flex; justify-content:center; align-items:center; color:var(--gray-color);">
                                Graphique des publications scientifiques
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="content-section">
                    <h2 class="section-title">Répartition des Étudiants par Département</h2>
                    <div class="chart-container">
                        <!-- Placeholder for chart -->
                        <div style="width:100%; height:100%; background:rgba(226, 232, 240, 0.3); border-radius:10px; display:flex; justify-content:center; align-items:center; color:var(--gray-color);">
                            Graphique de répartition des étudiants
                        </div>
                    </div>
                </div>
                
                <div class="content-section">
                    <h2 class="section-title">Comparaison des Résultats Académiques</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Département</th>
                                <th>Taux de Réussite (%)</th>
                                <th>Moyenne Générale</th>
                                <th>Abandons (%)</th>
                                <th>Étudiants Excellents (%)</th>
                            </tr>
                        </thead>
                        <tbody id="resultats-academiques-table">
                            <!-- Le contenu sera généré dynamiquement -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modals -->
    <div class="modal-backdrop" id="modal-department-details">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="modal-department-title">Détails du Département</h3>
                <button class="modal-close" onclick="closeModal('modal-department-details')">&times;</button>
            </div>
            <div class="modal-content">
                <div class="form-group">
                    <div class="grid-2col">
                        <div>
                            <label class="form-label">Nom du Département</label>
                            <input type="text" class="form-input" id="modal-department-name" readonly>
                        </div>
                        <div>
                            <label class="form-label">Chef de Département</label>
                            <input type="text" class="form-input" id="modal-department-chef" readonly>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <div class="grid-2col">
                        <div>
                            <label class="form-label">Nombre d'Étudiants</label>
                            <input type="text" class="form-input" id="modal-department-etudiants" readonly>
                        </div>
                        <div>
                            <label class="form-label">Nombre d'Enseignants</label>
                            <input type="text" class="form-input" id="modal-department-enseignants" readonly>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Formations Proposées</label>
                    <ul id="modal-department-formations" style="padding-left: 20px; margin-top: 10px;">
                        <!-- Le contenu sera généré dynamiquement -->
                    </ul>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Performance Académique</label>
                    <div class="chart-container" style="height: 150px;">
                        <!-- Placeholder for chart -->
                        <div style="width:100%; height:100%; background:rgba(226, 232, 240, 0.3); border-radius:10px; display:flex; justify-content:center; align-items:center; color:var(--gray-color);">
                            Graphique de performance académique
                        </div>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button class="action-btn secondary" onclick="closeModal('modal-department-details')">Fermer</button>
                    <button class="action-btn">Générer Rapport Complet</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal-backdrop" id="modal-request-details">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="modal-request-title">Détails de la Demande</h3>
                <button class="modal-close" onclick="closeModal('modal-request-details')">&times;</button>
            </div>
            <div class="modal-content">
                <div class="form-group">
                    <div class="grid-2col">
                        <div>
                            <label class="form-label">ID de Demande</label>
                            <input type="text" class="form-input" id="modal-request-id" readonly>
                        </div>
                        <div>
                            <label class="form-label">Date de Soumission</label>
                            <input type="text" class="form-input" id="modal-request-date" readonly>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <div class="grid-2col">
                        <div>
                            <label class="form-label">Département</label>
                            <input type="text" class="form-input" id="modal-request-department" readonly>
                        </div>
                        <div>
                            <label class="form-label">Type de Demande</label>
                            <input type="text" class="form-input" id="modal-request-type" readonly>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Objet</label>
                    <input type="text" class="form-input" id="modal-request-objet" readonly>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <textarea class="form-textarea" id="modal-request-description" readonly></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Pièces Jointes</label>
                    <ul id="modal-request-attachments" style="padding-left: 20px; margin-top: 10px;">
                        <!-- Le contenu sera généré dynamiquement -->
                    </ul>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Ajouter un Commentaire</label>
                    <textarea class="form-textarea" placeholder="Votre commentaire ici..."></textarea>
                </div>
                
                <div class="form-actions">
                    <button class="action-btn danger" onclick="closeModal('modal-request-details')">Refuser</button>
                    <button class="action-btn secondary" onclick="closeModal('modal-request-details')">Demander Plus d'Informations</button>
                    <button class="action-btn success">Approuver</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Mobile Menu Toggle Button for responsive design -->
    <div class="mobile-menu-toggle" id="mobile-menu-toggle" onclick="toggleSidebar()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
    </div>
    
    <script>
        // Données d'exemple pour les statistiques
        const statistiques = {
            totalEtudiants: 5823,
            totalEnseignants: 243,
            totalDepartements: 7,
            totalDemandes: 32,
            tauxSatisfaction: "87%",
            tauxReussite: "76%",
            completionCours: "93%",
            budgetUtilise: "62%"
        };

        // Données d'exemple pour les activités récentes
        const activitesRecentes = [
            { date: "13/04/2025", departement: "Informatique", activite: "Validation des notes du semestre", statut: "approved", statutText: "Approuvée" },
            { date: "12/04/2025", departement: "Mathématiques", activite: "Demande d'équipement supplémentaire", statut: "pending", statutText: "En attente" },
            { date: "11/04/2025", departement: "Physique", activite: "Recrutement d'enseignant associé", statut: "pending", statutText: "En attente" },
            { date: "10/04/2025", departement: "Chimie", activite: "Modification de programme de master", statut: "approved", statutText: "Approuvée" },
            { date: "09/04/2025", departement: "Biologie", activite: "Demande de financement laboratoire", statut: "denied", statutText: "Refusée" }
        ];

        // Données d'exemple pour les départements
        const departements = [
            { 
                id: "info", 
                nom: "Informatique", 
                chef: "Dr. Ahmed Touati", 
                etudiants: 1245, 
                enseignants: 56, 
                performance: 85,
                formations: [
                    "Licence en Informatique",
                    "Master en Intelligence Artificielle",
                    "Master en Sécurité Informatique",
                    "Master en Systèmes d'Information",
                    "Doctorat en Informatique"
                ]
            },
            { 
                id: "math", 
                nom: "Mathématiques", 
                chef: "Prof. Nadia Belkadi", 
                etudiants: 965, 
                enseignants: 42, 
                performance: 78,
                formations: [
                    "Licence en Mathématiques",
                    "Master en Mathématiques Appliquées",
                    "Master en Statistiques",
                    "Doctorat en Mathématiques"
                ]
            },
            { 
                id: "phys", 
                nom: "Physique", 
                chef: "Prof. Karim Hamdi", 
                etudiants: 875, 
                enseignants: 38, 
                performance: 92,
                formations: [
                    "Licence en Physique",
                    "Master en Physique Théorique",
                    "Master en Physique Appliquée",
                    "Doctorat en Physique"
                ]
            },
            { 
                id: "chim", 
                nom: "Chimie", 
                chef: "Dr. Leila Benziane", 
                etudiants: 798, 
                enseignants: 35, 
                performance: 65,
                formations: [
                    "Licence en Chimie",
                    "Master en Chimie Organique",
                    "Master en Chimie Analytique",
                    "Doctorat en Chimie"
                ]
            },
            { 
                id: "bio", 
                nom: "Biologie", 
                chef: "Prof. Mohammed Kamli", 
                etudiants: 1025, 
                enseignants: 45, 
                performance: 72,
                formations: [
                    "Licence en Biologie",
                    "Master en Biologie Moléculaire",
                    "Master en Écologie",
                    "Doctorat en Biologie"
                ]
            },
            { 
                id: "geo", 
                nom: "Géologie", 
                chef: "Dr. Samira Tazi", 
                etudiants: 542, 
                enseignants: 27, 
                performance: 59,
                formations: [
                    "Licence en Géologie",
                    "Master en Géologie Appliquée",
                    "Master en Hydrogéologie",
                    "Doctorat en Géologie"
                ]
            }
        ];

        // Données d'exemple pour les statuts des départements
        const statutsDepartements = [
            { id: "active", nom: "Actif" },
            { id: "issue", nom: "Problèmes signalés" }
        ];

        // Données d'exemple pour les types de demandes
        const typesDemandes = [
            { id: "financial", nom: "Financier" },
            { id: "academic", nom: "Académique" },
            { id: "hr", nom: "Ressources Humaines" }
        ];

        // Données d'exemple pour les priorités
        const priorites = [
            { id: "high", nom: "Haute", classe: "status-approved" },
            { id: "medium", nom: "Moyenne", classe: "status-pending" },
            { id: "low", nom: "Basse", classe: "status-pending" }
        ];

        // Données d'exemple pour les statuts des demandes
        const statutsDemandes = [
            { id: "pending", nom: "En attente", classe: "status-pending" },
            { id: "approved", nom: "Approuvée", classe: "status-approved" },
            { id: "denied", nom: "Refusée", classe: "status-denied" }
        ];

        // Données d'exemple pour les demandes en attente
        const demandesEnAttente = [
            { 
                id: "DEM-2025-0142", 
                date: "12/04/2025", 
                departement: "Mathématiques", 
                type: "Financier", 
                objet: "Demande d'équipement supplémentaire", 
                priorite: "medium", 
                prioriteText: "Moyenne",
                description: "Le département de Mathématiques demande l'acquisition de 25 ordinateurs portables pour équiper la nouvelle salle de travaux pratiques. Ces équipements sont nécessaires pour les cours d'analyse numérique et de modélisation mathématique. Le budget estimé est de 35,000 DZD par unité, soit un total de 875,000 DZD.",
                attachments: [
                    { nom: "Devis_Fournisseur.pdf", url: "#" },
                    { nom: "Justification_Pedagogique.pdf", url: "#" },
                    { nom: "Planning_Utilisation.xlsx", url: "#" }
                ]
            },
            { 
                id: "DEM-2025-0141", 
                date: "11/04/2025", 
                departement: "Physique", 
                type: "RH", 
                objet: "Recrutement d'enseignant associé", 
                priorite: "high", 
                prioriteText: "Haute",
                description: "Le département de Physique demande l'autorisation de recruter un enseignant associé spécialisé en physique quantique pour renforcer l'équipe pédagogique.",
                attachments: [
                    { nom: "Profil_Poste.pdf", url: "#" },
                    { nom: "Budget_Previsionnel.pdf", url: "#" }
                ]
            },
            { 
                id: "DEM-2025-0140", 
                date: "09/04/2025", 
                departement: "Biologie", 
                type: "Financier", 
                objet: "Demande de financement laboratoire", 
                priorite: "high", 
                prioriteText: "Haute",
                description: "Le département de Biologie sollicite un financement pour l'acquisition de nouveaux microscopes électroniques pour le laboratoire de recherche.",
                attachments: [
                    { nom: "Devis_Equipement.pdf", url: "#" },
                    { nom: "Projet_Recherche.pdf", url: "#" }
                ]
            },
            { 
                id: "DEM-2025-0139", 
                date: "08/04/2025", 
                departement: "Informatique", 
                type: "Académique", 
                objet: "Modification de programme de licence", 
                priorite: "medium", 
                prioriteText: "Moyenne",
                description: "Le département d'Informatique propose une mise à jour du programme de licence pour inclure davantage de modules sur l'intelligence artificielle et la science des données.",
                attachments: [
                    { nom: "Nouveau_Programme.pdf", url: "#" },
                    { nom: "Comparatif_Programmes.xlsx", url: "#" }
                ]
            },
            { 
                id: "DEM-2025-0138", 
                date: "07/04/2025", 
                departement: "Géologie", 
                type: "Académique", 
                objet: "Organisation de conférence internationale", 
                priorite: "low", 
                prioriteText: "Basse",
                description: "Le département de Géologie souhaite organiser une conférence internationale sur les changements climatiques et leur impact sur la géologie locale.",
                attachments: [
                    { nom: "Programme_Conference.pdf", url: "#" },
                    { nom: "Budget_Previsionnel.xlsx", url: "#" },
                    { nom: "Liste_Intervenants.pdf", url: "#" }
                ]
            }
        ];

        // Données d'exemple pour les demandes traitées
        const demandesTraitees = [
            { 
                id: "DEM-2025-0137", 
                date: "05/04/2025", 
                departement: "Chimie", 
                type: "Financier", 
                objet: "Acquisition de matériel laboratoire", 
                statut: "approved", 
                statutText: "Approuvée",
                description: "Le département de Chimie a demandé l'acquisition de nouveaux équipements pour le laboratoire d'analyse chimique.",
                attachments: [
                    { nom: "Liste_Equipements.pdf", url: "#" },
                    { nom: "Devis_Final.pdf", url: "#" }
                ]
            },
            { 
                id: "DEM-2025-0136", 
                date: "04/04/2025", 
                departement: "Informatique", 
                type: "RH", 
                objet: "Recrutement de vacataires", 
                statut: "approved", 
                statutText: "Approuvée",
                description: "Le département d'Informatique a demandé l'autorisation de recruter trois vacataires pour les travaux pratiques en programmation.",
                attachments: [
                    { nom: "Profils_Recherches.pdf", url: "#" },
                    { nom: "Planning_Cours.pdf", url: "#" }
                ]
            },
            { 
                id: "DEM-2025-0135", 
                date: "03/04/2025", 
                departement: "Mathématiques", 
                type: "Académique", 
                objet: "Création d'une nouvelle spécialité", 
                statut: "denied", 
                statutText: "Refusée",
                description: "Le département de Mathématiques a proposé la création d'une nouvelle spécialité en mathématiques financières.",
                attachments: [
                    { nom: "Programme_Propose.pdf", url: "#" },
                    { nom: "Etude_Marche.pdf", url: "#" }
                ]
            }
        ];

        // Données d'exemple pour les résultats académiques
        const resultatsAcademiques = [
            { departement: "Informatique", tauxReussite: 78, moyenneGenerale: "13.2/20", tauxAbandons: 5, tauxExcellents: 22 },
            { departement: "Mathématiques", tauxReussite: 74, moyenneGenerale: "12.8/20", tauxAbandons: 9, tauxExcellents: 18 },
            { departement: "Physique", tauxReussite: 82, moyenneGenerale: "13.6/20", tauxAbandons: 4, tauxExcellents: 25 },
            { departement: "Chimie", tauxReussite: 71, moyenneGenerale: "12.4/20", tauxAbandons: 11, tauxExcellents: 16 },
            { departement: "Biologie", tauxReussite: 79, moyenneGenerale: "13.5/20", tauxAbandons: 7, tauxExcellents: 23 },
            { departement: "Géologie", tauxReussite: 68, moyenneGenerale: "11.9/20", tauxAbandons: 14, tauxExcellents: 12 }
        ];

        // Fonction pour charger les données
        function loadData() {
            // Mettre à jour les statistiques
            document.getElementById('total-etudiants').textContent = statistiques.totalEtudiants;
            document.getElementById('total-enseignants').textContent = statistiques.totalEnseignants;
            document.getElementById('total-departements').textContent = statistiques.totalDepartements;
            document.getElementById('total-demandes').textContent = statistiques.totalDemandes;
            
            if (document.getElementById('taux-satisfaction')) {
                document.getElementById('taux-satisfaction').textContent = statistiques.tauxSatisfaction;
                document.getElementById('taux-reussite').textContent = statistiques.tauxReussite;
                document.getElementById('completion-cours').textContent = statistiques.completionCours;
                document.getElementById('budget-utilise').textContent = statistiques.budgetUtilise;
            }

            // Charger les activités récentes
            const activitesTable = document.getElementById('activites-recentes-table');
            if (activitesTable) {
                activitesTable.innerHTML = '';
                activitesRecentes.forEach(activite => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${activite.date}</td>
                        <td>${activite.departement}</td>
                        <td>${activite.activite}</td>
                        <td><span class="status status-${activite.statut}">${activite.statutText}</span></td>
                    `;
                    activitesTable.appendChild(row);
                });
            }

            // Charger les options pour les filtres de statuts des départements
            const filterStatutDepartement = document.getElementById('filter-statut-departement');
            if (filterStatutDepartement) {
                filterStatutDepartement.innerHTML = '<option value="">Tous les statuts</option>';
                statutsDepartements.forEach(statut => {
                    const option = document.createElement('option');
                    option.value = statut.id;
                    option.textContent = statut.nom;
                    filterStatutDepartement.appendChild(option);
                });
            }

            // Charger la table des départements
            const departementsTable = document.getElementById('departements-table');
            if (departementsTable) {
                departementsTable.innerHTML = '';
                departements.forEach(departement => {
                    const row = document.createElement('tr');
                    const performanceColor = departement.performance >= 70 ? 'var(--success-color)' : 'var(--warning-color)';
                    row.innerHTML = `
                        <td>${departement.nom}</td>
                        <td>${departement.chef}</td>
                        <td>${departement.etudiants}</td>
                        <td>${departement.enseignants}</td>
                        <td>
                            <div style="width:100%; background-color:#e2e8f0; border-radius:10px; height:10px;">
                                <div style="width:${departement.performance}%; background:linear-gradient(to right, ${performanceColor}, ${departement.performance >= 70 ? '#10b981' : '#d97706'}); height:10px; border-radius:10px;"></div>
                            </div>
                        </td>
                        <td>
                            <button class="action-btn success" onclick="voirDetailsDepartement('${departement.id}')">Détails</button>
                            <button class="action-btn secondary">Rapports</button>
                        </td>
                    `;
                    departementsTable.appendChild(row);
                });
            }

            // Charger les options pour les filtres de types de demandes
            const filterTypeDemande = document.getElementById('filter-type-demande');
            if (filterTypeDemande) {
                filterTypeDemande.innerHTML = '<option value="">Tous les types</option>';
                typesDemandes.forEach(type => {
                    const option = document.createElement('option');
                    option.value = type.id;
                    option.textContent = type.nom;
                    filterTypeDemande.appendChild(option);
                });
            }

            // Charger les options pour les filtres de départements
            const filterDepartement = document.getElementById('filter-departement');
            if (filterDepartement) {
                filterDepartement.innerHTML = '<option value="">Tous les départements</option>';
                departements.forEach(departement => {
                    const option = document.createElement('option');
                    option.value = departement.id;
                    option.textContent = departement.nom;
                    filterDepartement.appendChild(option);
                });
            }

            // Charger la table des demandes en attente
            const demandesEnAttenteTable = document.getElementById('demandes-en-attente-table');
            if (demandesEnAttenteTable) {
                demandesEnAttenteTable.innerHTML = '';
                demandesEnAttente.forEach(demande => {
                    const prioriteClass = demande.priorite === 'high' ? 'status-approved' : demande.priorite === 'medium' ? 'status-pending' : 'status-pending';
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${demande.id}</td>
                        <td>${demande.date}</td>
                        <td>${demande.departement}</td>
                        <td>${demande.type}</td>
                        <td>${demande.objet}</td>
                        <td><span class="status ${prioriteClass}">${demande.prioriteText}</span></td>
                        <td>
                            <button class="action-btn" onclick="voirDetailsDemande('${demande.id}')">Examiner</button>
                            <button class="action-btn success">Approuver</button>
                            <button class="action-btn danger">Refuser</button>
                        </td>
                    `;
                    demandesEnAttenteTable.appendChild(row);
                });
            }

            // Charger la table des demandes traitées
            const demandesTraiteesTable = document.getElementById('demandes-traitees-table');
            if (demandesTraiteesTable) {
                demandesTraiteesTable.innerHTML = '';
                demandesTraitees.forEach(demande => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${demande.id}</td>
                        <td>${demande.date}</td>
                        <td>${demande.departement}</td>
                        <td>${demande.type}</td>
                        <td>${demande.objet}</td>
                        <td><span class="status status-${demande.statut}">${demande.statutText}</span></td>
                        <td>
                            <button class="action-btn" onclick="voirDetailsDemande('${demande.id}')">Détails</button>
                        </td>
                    `;
                    demandesTraiteesTable.appendChild(row);
                });
            }

            // Charger la table des résultats académiques
            const resultatsAcademiquesTable = document.getElementById('resultats-academiques-table');
            if (resultatsAcademiquesTable) {
                resultatsAcademiquesTable.innerHTML = '';
                resultatsAcademiques.forEach(resultat => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${resultat.departement}</td>
                        <td>${resultat.tauxReussite}</td>
                        <td>${resultat.moyenneGenerale}</td>
                        <td>${resultat.tauxAbandons}</td>
                        <td>${resultat.tauxExcellents}</td>
                    `;
                    resultatsAcademiquesTable.appendChild(row);
                });
            }
        }

        // Fonction pour voir les détails d'un département
        function voirDetailsDepartement(departementId) {
            const departement = departements.find(d => d.id === departementId);
            if (departement) {
                document.getElementById('modal-department-title').textContent = `Détails du Département ${departement.nom}`;
                document.getElementById('modal-department-name').value = departement.nom;
                document.getElementById('modal-department-chef').value = departement.chef;
                document.getElementById('modal-department-etudiants').value = departement.etudiants;
                document.getElementById('modal-department-enseignants').value = departement.enseignants;
                
                const formationsList = document.getElementById('modal-department-formations');
                formationsList.innerHTML = '';
                departement.formations.forEach(formation => {
                    const li = document.createElement('li');
                    li.textContent = formation;
                    formationsList.appendChild(li);
                });
                
                openModal('modal-department-details');
            }
        }

        // Fonction pour voir les détails d'une demande
        function voirDetailsDemande(demandeId) {
            const demande = [...demandesEnAttente, ...demandesTraitees].find(d => d.id === demandeId);
            if (demande) {
                document.getElementById('modal-request-title').textContent = `Détails de la Demande ${demande.id}`;
                document.getElementById('modal-request-id').value = demande.id;
                document.getElementById('modal-request-date').value = demande.date;
                document.getElementById('modal-request-department').value = demande.departement;
                document.getElementById('modal-request-type').value = demande.type;
                document.getElementById('modal-request-objet').value = demande.objet;
                document.getElementById('modal-request-description').value = demande.description;
                
                const attachmentsList = document.getElementById('modal-request-attachments');
                attachmentsList.innerHTML = '';
                demande.attachments.forEach(attachment => {
                    const li = document.createElement('li');
                    li.innerHTML = `<a href="${attachment.url}" style="color: var(--primary-color);">${attachment.nom}</a>`;
                    attachmentsList.appendChild(li);
                });
                
                openModal('modal-request-details');
            }
        }

        // Function to change active tab
        function activateTab(element, contentId) {
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Add active class to clicked tab
            element.classList.add('active');
            
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Show the selected tab content
            document.getElementById(contentId).classList.add('active');
        }
        
        // Function to change section based on sidebar menu
        function changeTab(tabId) {
            // Remove active class from all menu items
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Add active class to clicked menu item
            event.currentTarget.classList.add('active');
            
            // Get corresponding tab content
            let contentId = tabId + '-content';
            
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Show the selected tab content
            document.getElementById(contentId).classList.add('active');
            
            // On mobile, close the sidebar after selection
            if (window.innerWidth < 992) {
                document.getElementById('sidebar').classList.remove('active');
            }
        }
        
        // Function to toggle sidebar on mobile
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('active');
        }
        
        // Function to open modal
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }
        
        // Function to close modal
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        // Close modal when clicking outside of it
        window.onclick = function(event) {
            if (event.target.classList.contains('modal-backdrop')) {
                event.target.style.display = 'none';
            }
        }

        // Initialiser les données au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
        });

        document.addEventListener('DOMContentLoaded', function() {
            const REQUIRED_ROLE = 'doyen'; // Hardcoded role
            const token = sessionStorage.getItem('admin_token') || localStorage.getItem('admin_token');
            
            if (!token) {
                window.location.href = `admin-login.html?requestedRole=${REQUIRED_ROLE}`;
                return;
            }
        
            fetch('http://localhost:3000/api/auth/verify', {
                method: 'GET',
                headers: { 
                  'Authorization': `Bearer ${token}`,
                  'Content-Type': 'application/json'
                },
                mode: 'cors',
                credentials: 'include'
              })
            .then(response => {
                if (!response.ok) throw new Error('Invalid token');
                return response.json();
            })
            .then(data => {
                if (data.adminRole !== REQUIRED_ROLE) {
                    throw new Error('Role mismatch');
                }
                // Load protected content here
            })
            .catch(error => {
                console.error('Access denied:', error);
                sessionStorage.clear();
                localStorage.clear();
                window.location.href = `admin-login.html?requestedRole=${REQUIRED_ROLE}`;
            });
        });
    </script>
</body>
</html>